@model IEnumerable<PIS_Project.Models.DataClasses.Card>

@{
    ViewBag.Title = "ShowRegister";
}

<h2>@ViewBag.OMSU</h2>

<p>
    @if (ViewBag.Role == "2" || ViewBag.Role == "0")
    {@Html.ActionLink("Добавить новую карту", "Create")}
</p>
<p>
    @if (ViewBag.Role == "2" || ViewBag.Role == "0")
    {@Html.ActionLink("Добавить новую карту через журнал отловленных", "ShowRegisterCatched")}
</p>

<div class="btn btn-success" id="filtersShowButton" style="background-color: #aebfbe; border-color: #aebfbe">Показать фильтры</div>
<div id="filtersDiv">
    @using (Html.BeginForm("ShowRegister", "Register", FormMethod.Post, new { @class = "mb-4", id = "filtersForm" }))
    {
        <div class="form-group row">
            <div class="col-lg-6">
                <label class="label-control">Пол:</label>
                <div>
                    <div class="w-100 mb-2" style="background-color: #e0f2f1; padding: 5px 0px 5px 10px; border-radius: 5px; border: 1px solid rgba(0,0,0,.1);">
                        <input class="sex-list" type="checkbox" id="filterSex1"
                               name="filters[sex]" value="1">
                        <label for="filterSex1">Мужской</label>
                    </div>
                    <div class="w-100 mb-2" style="background-color: #e0f2f1; padding: 5px 0px 5px 10px; border-radius: 5px; border: 1px solid rgba(0,0,0,.1);">
                        <input class="sex-list" type="checkbox" id="filterSex2"
                               name="filters[sex]" value="2">
                        <label for="filterSex2">Женский</label>
                    </div>
                </div>
            </div>

            <div class="col-lg-6">
                <label class="label-control">Статус:</label>
                <div>
                    <div class="w-100 mb-2" style="background-color: #e0f2f1; padding: 5px 0px 5px 10px; border-radius: 5px; border: 1px solid rgba(0,0,0,.1);">
                        <input class="status-list" type="checkbox" id="filterStatus1"
                               name="filters[status]" value="0">
                        <label for="filterSex1">Выбыл</label>
                    </div>
                    <div class="w-100 mb-2" style="background-color: #e0f2f1; padding: 5px 0px 5px 10px; border-radius: 5px; border: 1px solid rgba(0,0,0,.1);">
                        <input class="status-list" type="checkbox" id="filterStatus2"
                               name="filters[status]" value="1">
                        <label for="filterSex2">В приюте</label>
                    </div>
                </div>
            </div>
        </div>

        <div class="form-group row">
            <div class="col-lg-3">
                <label class="label-control">Размер животного:</label>
                <div>
                    <div class="w-100 mb-2" style="background-color: #e0f2f1; padding: 5px 0px 5px 10px; border-radius: 5px; border: 1px solid rgba(0,0,0,.1);">
                        <input class="animal-size-list" type="checkbox" id="filterAnimalSize1"
                               name="filters[animal_size]" value="11">
                        <label for="filterSex1">Большой</label>
                    </div>
                    <div class="w-100 mb-2" style="background-color: #e0f2f1; padding: 5px 0px 5px 10px; border-radius: 5px; border: 1px solid rgba(0,0,0,.1);">
                        <input class="animal-size-list" type="checkbox" id="filterAnimalSize2"
                               name="filters[animal_size]" value="10">
                        <label for="filterSex2">Средний</label>
                    </div>
                    <div class="w-100 mb-2" style="background-color: #e0f2f1; padding: 5px 0px 5px 10px; border-radius: 5px; border: 1px solid rgba(0,0,0,.1);">
                        <input class="animal-size-list" type="checkbox" id="filterAnimalSize1"
                               name="filters[animal_size]" value="1">
                        <label for="filterSex2">Маленький</label>
                    </div>
                </div>
            </div>

            <div class="col-lg-3">
                <label class="label-control">Вид животного:</label>
                <div>
                    <div class="w-100 mb-2" style="background-color: #e0f2f1; padding: 5px 0px 5px 10px; border-radius: 5px; border: 1px solid rgba(0,0,0,.1);">
                        <input class="animal-species-list" type="checkbox" id="filterAnimalSpecies1"
                               name="filters[animal_species]" value="0">
                        <label for="filterSex1">Кошка</label>
                    </div>
                    <div class="w-100 mb-2" style="background-color: #e0f2f1; padding: 5px 0px 5px 10px; border-radius: 5px; border: 1px solid rgba(0,0,0,.1);">
                        <input class="animal-species-list" type="checkbox" id="filterAnimalSpecies2"
                               name="filters[animal_species]" value="1">
                        <label for="filterSex2">Собака</label>
                    </div>
                </div>
            </div>

            <div class="col-lg-3">
                <label class="label-control">Длина шерсти:</label>
                <div>
                    <div class="w-100 mb-2" style="background-color: #e0f2f1; padding: 5px 0px 5px 10px; border-radius: 5px; border: 1px solid rgba(0,0,0,.1);">
                        <input class="animal-hire-size-list" type="checkbox" id="filterAnimalHireSize1"
                               name="filters[animal_hire_size]" value="1">
                        <label for="filterSex1">Длинношерстный</label>
                    </div>
                    <div class="w-100 mb-2" style="background-color: #e0f2f1; padding: 5px 0px 5px 10px; border-radius: 5px; border: 1px solid rgba(0,0,0,.1);">
                        <input class="animal-hire-size-list" type="checkbox" id="filterAnimalHireSize2"
                               name="filters[animal_hire_size]" value="0">
                        <label for="filterSex2">Короткошерстный</label>
                    </div>
                </div>
            </div>

            <div class="col-lg-3">
                <label class="label-control">Тип шерсти:</label>
                <div>
                    <div class="w-100 mb-2" style="background-color: #e0f2f1; padding: 5px 0px 5px 10px; border-radius: 5px; border: 1px solid rgba(0,0,0,.1);">
                        <input class="animal-hire-type-list" type="checkbox" id="filterAnimalHireType1"
                               name="filters[animal_type_type]" value="0">
                        <label for="filterSex1">Прямая</label>
                    </div>
                    <div class="w-100 mb-2" style="background-color: #e0f2f1; padding: 5px 0px 5px 10px; border-radius: 5px; border: 1px solid rgba(0,0,0,.1);">
                        <input class="animal-hire-type-list" type="checkbox" id="filterAnimalHireType2"
                               name="filters[animal_hire_type]" value="1">
                        <label for="filterSex2">Кудрявая</label>
                    </div>
                </div>
            </div>
        </div>


        <div class="form-group row" style="margin-right: 0; margin-left: 0;">
            <label class="label-control w-100">Статус:</label>
            <div style="display: inline-flex; flex-wrap: wrap; width:100%; align-items: center; justify-content: space-between; padding-left: 0">
                <div class="col-lg-2 text-center" style="background-color: #e0f2f1; padding: 5px 0px 5px 0px; border-radius: 5px; border: 1px solid rgba(0,0,0,.1);">
                    <input class="traits-list" type="checkbox" id="filterOwnerTraits1"
                           name="filters[owner_traits_1]" value="collar">
                    <label for="filterOwnerTraits1">Ошейник</label>
                </div>
                <div class="col-lg-2 text-center" style="background-color: #e0f2f1; padding: 5px 0px 5px 0px; border-radius: 5px; border: 1px solid rgba(0,0,0,.1);">
                    <input class="traits-list" type="checkbox" id="filterOwnerTraits2"
                           name="filters[owner_traits_2]" value="harness">
                    <label for="filterOwnerTraits2">Шлейка</label>
                </div>
                <div class="col-lg-2 text-center" style="background-color: #e0f2f1; padding: 5px 0px 5px 0px; border-radius: 5px; border: 1px solid rgba(0,0,0,.1);">
                    <input class="traits-list" type="checkbox" id="filterOwnerTraits3"
                           name="filters[owner_traits_3]" value="clothing">
                    <label for="filterOwnerTraits3">Одежда</label>
                </div>
                <div class="col-lg-2 text-center" style="background-color: #e0f2f1; padding: 5px 0px 5px 0px; border-radius: 5px; border: 1px solid rgba(0,0,0,.1);">
                    <input class="traits-list" type="checkbox" id="filterOwnerTraits4"
                           name="filters[owner_traits_4]" value="chip">
                    <label for="filterOwnerTraits4">Чип</label>
                </div>
                <div class="col-lg-2 text-center" style="background-color: #e0f2f1; padding: 5px 0px 5px 0px; border-radius: 5px; border: 1px solid rgba(0,0,0,.1);">
                    <input type="checkbox" id="noTraitsCheckbox"
                           name="filters[owner_traits_5]" value="no">
                    <label for="filterOwnerTraits5">Нет</label>
                </div>
            </div>
        </div>

        <div class="form-group row mb-2" style="margin-right: 0; margin-left: 0;">
            <div class="col-xl-4 pl-xl-0">
                <label class="w-100">Дата рождения:</label>
                <div class="w-100 text-center" style="background-color: #e0f2f1; padding: 10px 0px 10px 0px; border-radius: 5px; border: 1px solid rgba(0,0,0,.1);">
                    <div class="d-inline">
                        <input type="date" id="filterBirthday1"
                               name="filters[birthday1]">
                    </div>
                    <span> - </span>
                    <div class="d-inline">
                        <input type="date" id="filterBirthday2"
                               name="filters[birthday2]" value="female">
                    </div>
                </div>
            </div>

            <div class="col-xl-4">
                <label class="w-100">Дата стерилизации:</label>
                <div class="w-100 text-center" style="background-color: #e0f2f1; padding: 10px 0px 10px 0px; border-radius: 5px; border: 1px solid rgba(0,0,0,.1);">
                    <div class="d-inline">
                        <input type="date" id="filterSterilizationDate1"
                               name="filters[sterilization_date_1]">
                    </div>
                    <span> - </span>
                    <div class="d-inline">
                        <input type="date" id="filterSterilizationDate2"
                               name="filters[sterilization_date_2]">
                    </div>
                </div>
            </div>


            <div class="col-xl-4 pr-xl-0">
                <label class="w-100">Дата смены статуса:</label>
                <div class="w-100 text-center" style="background-color: #e0f2f1; padding: 10px 0px 10px 0px; border-radius: 5px; border: 1px solid rgba(0,0,0,.1);">
                    <div class="d-inline">
                        <input type="date" id="filterStatusDate1"
                               name="filters[status_date_1]">
                    </div>
                    <span> - </span>
                    <div class="d-inline">
                        <input type="date" id="filterStatusDate2"
                               name="filters[status_date_2]">
                    </div>
                </div>
            </div>
        </div>
    
        }
<button class="btn btn-success" id="sendFilter" style="background-color: #aebfbe; border-color: #aebfbe">Применить</button>
</div>
@*@using (Html.BeginForm("Sort", "Register", FormMethod.Post, new { @class = "mb-4" }))
    {
        <div class="form-group row mb-2" style="margin-right: 0; margin-left: 0;">
            <div class="col-lg-8 pl-lg-0">
                <label>Значение для фильтрации:</label>
                <div>
                    @Html.TextBox("filters[search]", null, new { @class = "form-control" })
                </div>
            </div>
            <div class="col-lg-4 pr-lg-0">
                <label>Поле для поиска: </label>
                <div>
                    @Html.DropDownList("filters[field]", ViewBag.Fields as SelectList, new { @class = "form-control" })
                </div>
            </div>
        </div>
        <input сlass="btn btn-primary col-lg-3" id="sendSearch" name="action" type="submit" value="Поиск" />
    }*@


<table class="table">
    <thead class="thead-dark">
        <tr>
            <th class="col">
                @Html.ActionLink("Пол животного", "ShowRegister", new { sortOrder = "sex", upper = ViewData["sex"] })
            </th>
            <th class="col">
                @Html.DisplayNameFor(model => model.type)
            </th>
            <th class="col">
                @Html.ActionLink("Дата рождения", "ShowRegister", new { sortOrder = "birthday", upper = ViewData["birthday"] })
            </th>
            <th class="col">
                @Html.ActionLink("Метка", "ShowRegister", new { sortOrder = "id_mark", upper = ViewData["id_mark"] })
            </th>
            <th class="col">
                @Html.ActionLink("Номер чипа", "ShowRegister", new { sortOrder = "id_chip", upper = ViewData["id_chip"] })
            </th>
            <th class="col">
                @Html.ActionLink("Кличка", "ShowRegister", new { sortOrder = "name", upper = ViewData["name"] })
            </th>
            <th class="col">
                @Html.DisplayNameFor(model => model.spec_mark)
            </th>
            <th class="col">
                @Html.DisplayNameFor(model => model.owner_traits)
            </th>
            <th class="col">
                @Html.ActionLink("ID статус", "ShowRegister", new { sortOrder = "id_status", upper = ViewData["id_status"] })
            </th>
            <th class="col">
                @Html.ActionLink("Дата установки статуса", "ShowRegister", new { sortOrder = "date_status_change", upper = ViewData["date_status_change"] })
            </th>
            <th class="col">
                @Html.ActionLink("ID MU", "ShowRegister", new { sortOrder = "ID_MU", upper = ViewData["ID_MU"] })
            </th>
            <th class="col">
                @Html.ActionLink("Населенный пункт", "ShowRegister", new { sortOrder = "local_place", upper = ViewData["local_place"] })
            </th>
            <th class="col">
                @Html.ActionLink("Дата стерелизации", "ShowRegister", new { sortOrder = "sterilization_date", upper = ViewData["sterilization_date"] })
            </th>
            <th class="col">

            </th>
            <th class="col">

            </th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model)
        {
        <tr id="@item.ID">
            <td>
                @Html.DisplayFor(modelItem => item.sex)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.stringAnimalType)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.birthday)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.id_mark)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.id_chip)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.name)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.spec_mark)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.owner_traits)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.id_status)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.date_status_change)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.ID_MU)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.local_place)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.sterilization_date)
            </td>
            <td><p><button type="button" onclick="ChangeColor(this, @item.ID); return false;" value="@item.ID">Выбрать</button></p></td>
            >
            <td>
                @Html.ActionLink("Открыть", "Card", "Register", new { id_card = item.ID }, new { @class = "navbar-brand" })
            </td>
            <td>
                @if (ViewBag.Role == "2" || ViewBag.Role == "0" || ViewBag.Role == "1")
                {
                    if (item.id_status == 1) {
                    @Html.ActionLink("Редактировать", "EditCard", new { id_card = item.ID }, new { @class = "navbar-brand" })}
                @Html.ActionLink("Удалить", "Delete", new { id_card = item.ID }, new { @class = "navbar-brand" })
            }
            </td>
            </tr>
        }
    </tbody>
</table>

@section Scripts {
    <script type="text/javascript">
            function ChangeColor(Element, id) {
            let perem_2 = document.querySelectorAll("tr");
            for (let i = 0; i < perem_2.length; i++) {
                perem_2[i].style.backgroundColor = 'white';
            }
            document.getElementById(id).style.backgroundColor = "#a7d4d0";

        }

        let filterShowState = false;
        $(document).ready(function (e) {
            $('#filtersDiv').hide();
        });
        $("sendFilters").click(function (e) {
            $("#filtersForm").submit()
        });
        $('#filtersShowButton').click(function (e) {
            if (filterShowState) {
                filterShowState = false;
                $('#filtersDiv').hide();
                $(this).text("Показать фильтры")
            }
            else {
                filterShowState = true;
                $('#filtersDiv').show();
                $(this).text("Скрыть фильтры")
            }
        });
        $('.animal-size-list').on('change', function () {
            $('.animal-size-list').not(this).prop('checked', false);
        });
        $('.animal-species-list').on('change', function () {
            $('.animal-species-list').not(this).prop('checked', false);
        });
        $('.animal-hire-size-list').on('change', function () {
            $('.animal-hire-size-list').not(this).prop('checked', false);
        });
        $('.animal-hire-type-list').on('change', function () {
            $('.animal-hire-type-list').not(this).prop('checked', false);
        });
        $('.sex-list').on('change', function () {
            $('.sex-list').not(this).prop('checked', false);
        });
        $('.status-list').on('change', function () {
            $('.status-list').not(this).prop('checked', false);
        });
        $('.traits-list').on('change', function () {
            $("#noTraitsCheckbox").prop("checked", false);
        });
        $("#noTraitsCheckbox").on('change', function () {
            if ($(this).is(':checked')) {
                $('.traits-list').prop('checked', false)
            }
        });</script>
}